{
    "runtimeConfiguration": {
        "logLevel": "error",
        "logDestination": "stdout+platform",
        "maxLogFileSize": 2147483648,
        "headerTransactionName": "x-scan-request-id",
        "headerScenarioTransactionName": "x-scan-scenario-id",
        "flowrate": 10,
        "timeout": 30,
        "followRedirection": true,
        "happyPathRetry": 1,
        "happyPathOnly": false,
        "happyPathConformanceStrict": false,
        "maxScanTime": 3600,
        "memoryLimit": 2147483648,
        "memoryTimeSpan": 10,
        "indexed": false,
        "prettify": false,
        "maxBodySizeScan": 10485760,
        "maxHttpResponseSizeHappyPathReport": 0,
        "maxBodySizeHappyPathReport": 8092,
        "maxHttpResponseSizeTestReport": 0,
        "maxBodySizeTestReport": 8092,
        "errorsOnly": true,
        "maxIssues": 10000,
        "maxReportSize": 104857600
    },
    "version": "2.0.0",
    "authorizationTests": {
        "UserIsolation": {
            "key": "authentication-swapping-bola",
            "source": [
                "Cookie/User"
            ],
            "target": [
                "Cookie/User1"
            ]
        },
        "AdminOnly": {
            "key": "authentication-swapping-bfla",
            "source": [
                "Cookie/Admin"
            ],
            "target": [
                "Cookie/User"
            ]
        }
    },
    "authenticationDetails": [
        {
            "Cookie": {
                "type": "apiKey",
                "in": "cookie",
                "name": "session",
                "default": "Admin",
                "ttl": "30s",
                "credentials": {
                    "Admin": {
                        "description": "Admin Credential",
                        "requests": [
                            {
                                "environment": {
                                    "password": "HelloWorld",
                                    "user": "admin@42crunch.com"
                                },
                                "$ref": "#/requests/UserLoginAdmin",
                                "auth": []
                            }
                        ],
                        "credential": "{{sessionIdAdmin}}"
                    },
                    "User": {
                        "description": "User Credential",
                        "requests": [
                            {
                                "environment": {
                                    "password": "HelloWorld",
                                    "user": "user@42crunch.com"
                                },
                                "$ref": "#/requests/UserLogin",
                                "auth": []
                            }
                        ],
                        "credential": "{{sessionId}}"
                    },
                    "User1": {
                        "description": "User Credential",
                        "requests": [
                            {
                                "environment": {
                                    "password": "HelloWorld",
                                    "user": "user1@42crunch.com"
                                },
                                "$ref": "#/requests/UserLogin",
                                "auth": []
                            }
                        ],
                        "credential": "{{sessionId}}"
                    }
                }
            }
        }
    ],
    "apiVersion": [
        {
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/version",
                    "method": "get",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {}
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            },
            "responseProcessing": {
                "variableAssignments": {
                    "httpStatus": 200,
                    "variables": {
                        "version": "${json_pointer(json(http.response.body),'/version')}"
                    }
                }
            }
        }
    ],
    "playbook": {
        "skippedKeys": [
            "path-item-method-not-allowed-scan"
        ],
        "responseAnalysisBehavior": {
            "path-item-method-not-allowed-scan": {
                "httpStatusExpected": [
                    "400"
                ]
            }
        },
        "paths": {
            "/dump1": {
                "get": {
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/Dump"
                                }
                            ]
                        }
                    ],
                    "customTests": [
                        {
                            "requests": [
                                {
                                    "request": {
                                        "type": "42c",
                                        "requestDetails": {
                                            "host": "{{host}}",
                                            "path": "/version",
                                            "method": "get",
                                            "pathParameters": {},
                                            "queryParameters": {},
                                            "headerParameters": {},
                                            "cookieParameters": {}
                                        }
                                    },
                                    "responseAnalysisBehavior": {
                                        "httpStatusExpected": [
                                            "200"
                                        ]
                                    },
                                    "responseProcessing": {
                                        "variableAssignments": {
                                            "httpStatus": 200,
                                            "variables": {
                                                "version": "${json_pointer(json(http.response.body),'/version')}"
                                            }
                                        }
                                    }
                                }
                            ],
                            "key": "authentication-swapping-bola"
                        }
                    ]
                }
            },
            "/dump": {
                "get": {
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/Dump"
                                }
                            ]
                        }
                    ],
                    "customTests": [
                        {
                            "requests": [
                                {
                                    "request": {
                                        "type": "42c",
                                        "requestDetails": {
                                            "host": "{{host}}",
                                            "path": "/version",
                                            "method": "get",
                                            "pathParameters": {},
                                            "queryParameters": {},
                                            "headerParameters": {},
                                            "cookieParameters": {}
                                        }
                                    },
                                    "responseAnalysisBehavior": {
                                        "httpStatusExpected": [
                                            "200"
                                        ]
                                    },
                                    "responseProcessing": {
                                        "variableAssignments": {
                                            "httpStatus": 200,
                                            "variables": {
                                                "version": "${json_pointer(json(http.response.body),'/version')}"
                                            }
                                        }
                                    }
                                }
                            ],
                            "key": "authentication-swapping-bola"
                        }
                    ]
                },
                "post": {
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/Dump"
                                }
                            ]
                        }
                    ],
                    "customTests": [
                        {
                            "requests": [
                                {
                                    "request": {
                                        "type": "42c",
                                        "requestDetails": {
                                            "host": "{{host}}",
                                            "path": "/version",
                                            "method": "get",
                                            "pathParameters": {},
                                            "queryParameters": {},
                                            "headerParameters": {},
                                            "cookieParameters": {}
                                        }
                                    },
                                    "responseAnalysisBehavior": {
                                        "httpStatusExpected": [
                                            "200"
                                        ]
                                    },
                                    "responseProcessing": {
                                        "variableAssignments": {
                                            "httpStatus": 200,
                                            "variables": {
                                                "version": "${json_pointer(json(http.response.body),'/version')}"
                                            }
                                        }
                                    }
                                }
                            ],
                            "key": "authentication-swapping-bola"
                        }
                    ]
                }
            },
            "/users": {
                "post": {
                    "authorizationTests": [
                        "AdminOnly"
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreateUser"
                                }
                            ]
                        },
                        {
                            "key": "happy.path.failure",
                            "requests": [
                                {
                                    "request": {
                                        "type": "42c",
                                        "requestDetails": {
                                            "host": "{{host}}",
                                            "path": "/users",
                                            "method": "post",
                                            "pathParameters": {},
                                            "queryParameters": {},
                                            "headerParameters": {
                                                "Content-Type": "application/json"
                                            },
                                            "cookieParameters": {},
                                            "requestBody": {
                                                "mode": "json",
                                                "json": {
                                                    "user": 10,
                                                    "password": "HelloWorld@1"
                                                }
                                            }
                                        }
                                    },
                                    "responseAnalysisBehavior": {
                                        "httpStatusExpected": [
                                            "400"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "key": "happy.path.failure",
                            "requests": [
                                {
                                    "auth": [
                                        "Cookie"
                                    ],
                                    "request": {
                                        "type": "42c",
                                        "requestDetails": {
                                            "host": "{{host}}",
                                            "path": "/users",
                                            "method": "post",
                                            "pathParameters": {},
                                            "queryParameters": {},
                                            "headerParameters": {
                                                "Content-Type": "application/json"
                                            },
                                            "cookieParameters": {},
                                            "requestBody": {
                                                "mode": "json",
                                                "json": {
                                                    "user": "admin@42crunch.com",
                                                    "password": "pass123@"
                                                }
                                            }
                                        }
                                    },
                                    "responseAnalysisBehavior": {
                                        "httpStatusExpected": [
                                            "409"
                                        ]
                                    }
                                }
                            ]
                        }
                    ],
                    "auth": null
                }
            },
            "/users/{username}": {
                "delete": {
                    "authorizationTests": [
                        "UserIsolation"
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreateUser"
                                },
                                {
                                    "auth": [],
                                    "$ref": "#/requests/UserLogin"
                                },
                                {
                                    "auth": [
                                        {
                                            "type": "apiKey",
                                            "in": "cookie",
                                            "name": "session",
                                            "default": "User",
                                            "credentials": {
                                                "User": {
                                                    "description": "User Credential",
                                                    "credential": "{{sessionId}}"
                                                }
                                            }
                                        }
                                    ],
                                    "$ref": "#/requests/DeleteUser"
                                }
                            ]
                        }
                    ],
                    "auth": null
                }
            },
            "/petstores": {
                "get": {
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "auth": [],
                                    "$ref": "#/requests/FindPetstores"
                                }
                            ]
                        }
                    ],
                    "auth": null
                },
                "post": {
                    "authorizationTests": [
                        "AdminOnly"
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreatePetstore"
                                },
                                {
                                    "$ref": "#/requests/DeletePetstore"
                                }
                            ]
                        }
                    ]
                }
            },
            "/petstores/{id}": {
                "get": {
                    "before": [
                        {
                            "$ref": "#/requests/CreatePetstore"
                        }
                    ],
                    "after": [
                        {
                            "$ref": "#/requests/DeletePetstore"
                        }
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/ReadPetstore"
                                }
                            ]
                        }
                    ],
                    "auth": null
                },
                "delete": {
                    "authorizationTests": [
                        "AdminOnly"
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreatePetstore"
                                },
                                {
                                    "$ref": "#/requests/DeletePetstore"
                                }
                            ]
                        }
                    ],
                    "auth": null
                }
            },
            "/petstores/{id}/pets": {
                "get": {
                    "before": [
                        {
                            "$ref": "#/requests/CreatePetstore"
                        },
                        {
                            "$ref": "#/requests/CreatePet"
                        }
                    ],
                    "after": [
                        {
                            "$ref": "#/requests/DeletePet"
                        },
                        {
                            "$ref": "#/requests/DeletePetstore"
                        }
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/ListPets"
                                }
                            ]
                        }
                    ]
                }
            },
            "/pets": {
                "post": {
                    "before": [
                        {
                            "$ref": "#/requests/CreatePetstore"
                        }
                    ],
                    "after": [
                        {
                            "$ref": "#/requests/DeletePetstore"
                        }
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreatePet"
                                },
                                {
                                    "$ref": "#/requests/DeletePet"
                                }
                            ]
                        }
                    ]
                }
            },
            "/pets/{id}": {
                "get": {
                    "authorizationTests": [
                        "UserIsolation"
                    ],
                    "before": [
                        {
                            "$ref": "#/requests/CreatePetstore"
                        },
                        {
                            "$ref": "#/requests/CreatePet"
                        }
                    ],
                    "after": [
                        {
                            "$ref": "#/requests/DeletePet"
                        },
                        {
                            "$ref": "#/requests/DeletePetstore"
                        }
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/ReadPet"
                                }
                            ]
                        }
                    ]
                },
                "delete": {
                    "after": [
                        {
                            "$ref": "#/requests/DeletePetstore"
                        }
                    ],
                    "before": [
                        {
                            "$ref": "#/requests/CreatePetstore"
                        }
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreatePet"
                                },
                                {
                                    "$ref": "#/requests/DeletePet"
                                }
                            ]
                        }
                    ]
                }
            },
            "/pets/{id}/transfer": {
                "put": {
                    "authorizationTests": [
                        "UserIsolation"
                    ],
                    "before": [
                        {
                            "$ref": "#/requests/CreatePetstore"
                        },
                        {
                            "auth": [
                                "Cookie"
                            ],
                            "request": {
                                "type": "42c",
                                "requestDetails": {
                                    "host": "{{host}}",
                                    "path": "/petstores",
                                    "method": "post",
                                    "pathParameters": {},
                                    "queryParameters": {},
                                    "headerParameters": {
                                        "Content-Type": "application/json"
                                    },
                                    "cookieParameters": {},
                                    "requestBody": {
                                        "mode": "json",
                                        "json": {
                                            "name": "{{$random}}"
                                        }
                                    }
                                }
                            },
                            "responseAnalysisBehavior": {
                                "httpStatusExpected": [
                                    "200"
                                ]
                            },
                            "responseProcessing": {
                                "variableAssignments": {
                                    "httpStatus": 200,
                                    "contentType": "application/json",
                                    "variables": {
                                        "newPetstoreId": "${json_pointer(json(http.response.body),'/id')}"
                                    }
                                }
                            }
                        }
                    ],
                    "after": [
                        {
                            "$ref": "#/requests/DeletePetstore"
                        },
                        {
                            "auth": [
                                "Cookie"
                            ],
                            "request": {
                                "type": "42c",
                                "requestDetails": {
                                    "host": "{{host}}",
                                    "path": "/petstores/{id}",
                                    "method": "delete",
                                    "pathParameters": {
                                        "id": "{{newPetstoreId}}"
                                    },
                                    "queryParameters": {},
                                    "headerParameters": {},
                                    "cookieParameters": {},
                                    "requestBody": null
                                }
                            },
                            "responseAnalysisBehavior": {
                                "httpStatusExpected": [
                                    "204"
                                ]
                            }
                        }
                    ],
                    "happyPaths": [
                        {
                            "key": "happy.path.success",
                            "requests": [
                                {
                                    "$ref": "#/requests/CreatePet"
                                },
                                {
                                    "$ref": "#/requests/ReadPet"
                                },
                                {
                                    "$ref": "#/requests/TransferPet"
                                },
                                {
                                    "$ref": "#/requests/DeletePet"
                                }
                            ]
                        }
                    ]
                }
            }
        }
    },
    "environment": {
        "host": "env_with_default('SCAN42C_HOST','http://localhost:4010')"
    },
    "requests": {
        "Dump": {
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/dump",
                    "method": "get",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {}
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            }
        },
        "UserLoginAdmin": {
            "auth": [],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/login",
                    "method": "post",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {
                        "Content-Type": "application/json"
                    },
                    "cookieParameters": {},
                    "requestBody": {
                        "mode": "json",
                        "json": {
                            "password": "{{password}}",
                            "user": "{{user}}"
                        }
                    }
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            },
            "responseProcessing": {
                "variableAssignments": {
                    "httpStatus": 200,
                    "variables": {
                        "sessionIdAdmin": "${http.response.cookies['session']}"
                    }
                }
            }
        },
        "UserLogin": {
            "auth": [],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/login",
                    "method": "post",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {
                        "Content-Type": "application/json"
                    },
                    "cookieParameters": {},
                    "requestBody": {
                        "mode": "json",
                        "json": {
                            "password": "{{password}}",
                            "user": "{{user}}"
                        }
                    }
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            },
            "responseProcessing": {
                "variableAssignments": {
                    "httpStatus": 200,
                    "variables": {
                        "sessionId": "${http.response.cookies['session']}"
                    }
                }
            }
        },
        "CreateUser": {
            "auth": [
                "Cookie"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/users",
                    "method": "post",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {
                        "Content-Type": "application/json"
                    },
                    "cookieParameters": {},
                    "requestBody": {
                        "mode": "json",
                        "json": {
                            "user": "{{$random}}",
                            "password": "{{$random}}",
                            "isAdmin": false
                        }
                    }
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            },
            "responseProcessing": {
                "variableAssignments": {
                    "httpStatus": 200,
                    "contentType": "application/json",
                    "variables": {
                        "user": "${json_pointer(json(http.response.body),'/user')}",
                        "password": "${json_pointer(json(http.response.body),'/password')}"
                    }
                }
            }
        },
        "DeleteUser": {
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/users/{username}",
                    "method": "delete",
                    "pathParameters": {
                        "username": "{{user}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "204"
                ]
            }
        },
        "FindPetstores": {
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/petstores",
                    "method": "get",
                    "pathParameters": {},
                    "queryParameters": {
                        "limit": 10,
                        "name": "Petstore"
                    },
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            }
        },
        "CreatePetstore": {
            "auth": [
                "Cookie"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/petstores",
                    "method": "post",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {
                        "Content-Type": "application/json"
                    },
                    "cookieParameters": {},
                    "requestBody": {
                        "mode": "json",
                        "json": {
                            "name": "{{$random}}"
                        }
                    }
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            },
            "responseProcessing": {
                "variableAssignments": {
                    "httpStatus": 200,
                    "contentType": "application/json",
                    "variables": {
                        "petstoreId": "${json_pointer(json(http.response.body),'/id')}"
                    }
                }
            }
        },
        "ReadPetstore": {
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/petstores/{id}",
                    "method": "get",
                    "pathParameters": {
                        "id": "{{petstoreId}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            }
        },
        "DeletePetstore": {
            "auth": [
                "Cookie"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/petstores/{id}",
                    "method": "delete",
                    "pathParameters": {
                        "id": "{{petstoreId}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "204"
                ]
            }
        },
        "ListPets": {
            "auth": [
                "Cookie/User"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/petstores/{id}/pets",
                    "method": "get",
                    "pathParameters": {
                        "id": "{{petstoreId}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            }
        },
        "CreatePet": {
            "auth": [
                "Cookie/User"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/pets",
                    "method": "post",
                    "pathParameters": {},
                    "queryParameters": {},
                    "headerParameters": {
                        "Content-Type": "application/json"
                    },
                    "cookieParameters": {},
                    "requestBody": {
                        "mode": "json",
                        "json": {
                            "age": 10,
                            "name": "Billy",
                            "petstoreId": "{{petstoreId}}"
                        }
                    }
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            },
            "responseProcessing": {
                "variableAssignments": {
                    "httpStatus": 200,
                    "contentType": "application/json",
                    "variables": {
                        "petId": "${json_pointer(json(http.response.body),'/id')}"
                    }
                }
            }
        },
        "ReadPet": {
            "auth": [
                "Cookie/User"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/pets/{id}",
                    "method": "get",
                    "pathParameters": {
                        "id": "{{petId}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            }
        },
        "TransferPet": {
            "auth": [
                "Cookie/User"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/pets/{id}/transfer",
                    "method": "put",
                    "pathParameters": {
                        "id": "{{petId}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {
                        "Content-Type": "application/json"
                    },
                    "cookieParameters": {},
                    "requestBody": {
                        "mode": "json",
                        "json": {
                            "petstoreId": "{{newPetstoreId}}"
                        }
                    }
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "200"
                ]
            }
        },
        "DeletePet": {
            "auth": [
                "Cookie/User"
            ],
            "request": {
                "type": "42c",
                "requestDetails": {
                    "host": "{{host}}",
                    "path": "/pets/{id}",
                    "method": "delete",
                    "pathParameters": {
                        "id": "{{petId}}"
                    },
                    "queryParameters": {},
                    "headerParameters": {},
                    "cookieParameters": {},
                    "requestBody": null
                }
            },
            "responseAnalysisBehavior": {
                "httpStatusExpected": [
                    "204"
                ]
            }
        }
    }
}